const F=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function l(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=l(n);fetch(n.href,r)}};F();function O(e,[t,l],[o,n],r=4){const i=e[t][l];if(!i)return null;for(let c=1;c<r;c++){const s=t+o*c,f=l+n*c;if(s<0||s>=e.length||f<0||f>=6||e[s][f]!==i)return null}return i}function w(e,t=4){const l=new Map;l.set("red",0),l.set("yellow",0);for(let o=0;o<e.length;o++)for(let n=0;n<6;n++)for(let r=-1;r<=1;r++)for(let i=-1;i<=1;i++){if(r===0&&i===0)continue;const c=O(e,[o,n],[r,i],t);c&&l.set(c,l.get(c)+1)}return l}function W(e){const t=w(e,4);return t.get("yellow")!==0?"yellow":t.get("red")!==0?"red":null}function T(e){return W(e)}function g(e){for(const t of e)if(t.length<6)return!1;return!0}function m(e){switch(e){case"red":return"yellow";case"yellow":return"red"}}let k=0,L=0,S=null;async function B(e,t,l=!0,o=8){if(g(e))throw new Error("ohno");S=new Date,k=0,L=0;let n=[],r=-1/0;for(let i=0;i<e.length;i++)await new Promise(s=>{setTimeout(async()=>{if(e[i].length>=6)return s();const f=I(e,t,i),d=await b(f,m(t),o,-2e3,2e3)*(t==="yellow"?-1:1);d>r?(console.log("new best score",d,i),r=d,n=[i]):d===r&&(console.log("new equal score",d,i),n.push(i)),s()},0)});if(l){let i=new Date().getTime()-S.getTime();N(i)}return n[Math.floor(Math.random()*n.length)]}async function b(e,t,l,o,n){if(l===0)return k+=1,P(e,t);const r=T(e);if(r)return r===t?1e5:-1e5;if(g(e))return 0;for(const[i,c]of G(e,t)){const s=-await b(c,m(t),l-1,-n,-o);if(s>=n)return L+=1,n;o=Math.max(o,s)}return o}function G(e,t){const l=[];for(let o=0;o<7;o++){if(e[o].length>=6)continue;const n=I(e,t,o);l.push([o,P(n,t,!0),n])}return l.sort((o,n)=>n[1]-o[1]),l.map(([o,n,r])=>[o,r])}function I(e,t,l){return e.map((o,n)=>{const r=o.slice();return n===l&&r.push(t),r})}function P(e,t,l=!1){const o=T(e);if(o)return o===t?1e5:-1e5;if(g(e))return 0;const n=w(e,3);let r=n.get(t)*10-n.get(m(t))*10;if(l){const i=w(e,2);r+=i.get(t)*2-i.get(m(t))*2}return r}function N(e){document.getElementById("time-taken").innerText=e.toString()+"ms",document.getElementById("evaluated").innerText=k.toString(),document.getElementById("pruned").innerText=L.toString()}function C(e){return document.querySelector(`#col-${e}`)}const _=document.querySelector(".grid-container"),h=document.querySelector(".grid");function A(e){const t=document.createElement("div");return t.classList.add("token"),t.classList.add(`token-${e}`),t}function M(e){const t=document.createElement("h2");t.classList.add("win-message"),t.innerText=`${e} won!`,_.appendChild(t),y.remove()}function K(e,t){if(a[e].length>=6)return!1;const l=C(e);return l.appendChild(A(t)),a[e].push(t),a[e].length>=6&&l.classList.add("full"),!0}function R(){const e=[];for(let t=0;t<a.length;t++)a[t].length<6&&e.push(t);return e}let a=[[],[],[],[],[],[],[]],u="red";const y=document.querySelector("#to-move");let q=!1,x=!1,E=!1;function p(){h.classList.remove(u),u=m(u),h.classList.add(u),setTimeout(()=>{E?y.innerText=`${u}'s turn`:y.innerText=`${u} is thinking...`},1)}function D(){h.classList.add("caninteract"),E=!0;for(let e=0;e<7;e++){const t=C(e);t.onclick=()=>{$(e)}}}function v(){h.classList.remove("caninteract"),E=!1;for(let e=0;e<7;e++){const t=C(e);t.onclick=null}}function X(e,t=!1){v(),setTimeout(async()=>{if(q||x)return;let l=0;if(e==="red"){const o=R();l=o[Math.floor(Math.random()*o.length)]}else console.log("thinking"),l=await B(a,e),console.log("thunk");$(l),D()},0)}function $(e){if(K(e,u)){const t=T(a);t?(M(t),v(),q=!0):g(a)?(M("nobody"),v(),x=!0):(p(),u=="yellow"&&X(u))}}function Y(){D(),p(),p()}Y();
